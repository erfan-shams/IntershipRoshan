// function fetchRequets() {
//     const text = ' .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم] .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم] .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم]\
//      .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم] .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم] .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم.[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم] .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم] .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم]\
//      .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم] .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم] .[عشقی اگر] .[می کنی فرد] .تو آدم میره .خوب تو خوب تو دارم .آرزو که [دیگه رو] .خوب [تو] .[قبل] تو میشه [می گفتم] .با [خود] .خوب تو [رو خوب تو] .آرزو [مینه بمونه] که [ام] .خوب [دوم]'


//     const request = {
//         'id': 1,
//         'icon': 1, 'filename': 'https://www.figma.com/design/zMgepw1CI8fRGx7aX1BS8S/Ava?node-id=1-3300&t=njh2TPrbLCY9fLsh-0',
//         'upload_date': '1400-08-21', 'file_type': '.mp3', 'duration': '1:28:18', 'text': text, 'src_audio': 'https://ts17.tarafdari.com/contents/user874839/content-sound/fatemeh_mehlaban_-_atash_karevan_320.mp3',
//         'segments': [{ "start": "00:03", "end": '00:13', 'text': 'ft' }, { "start": "00:03", "end": '00:13', 'text': 'ft' }, { "start": "00:03", "end": '00:13', 'text': 'ft' }
//             , { "start": "00:03", "end": '00:13', 'text': 'ft' }, { "start": "00:03", "end": '00:13', 'text': 'ft' },
//             , { "start": "00:03", "end": '00:13', 'text': 'ft' }, { "start": "00:03", "end": '00:13', 'text': 'ft' },
//             , { "start": "00:03", "end": '00:13', 'text': 'ft' }, { "start": "00:03", "end": '00:13', 'text': 'ft' },
//             , { "start": "00:03", "end": '00:13', 'text': 'ft' }, { "start": "00:03", "end": '00:13', 'text': 'ft' },
//             , { "start": "00:03", "end": '00:13', 'text': 'ft' }, { "start": "00:03", "end": '00:13', 'text': 'ft' }
//         ]
//     }

//     const requests = []
//     for (let i = 1; i < 66; i++) {
//         request['duration'] = i + ":28:18"
//         request['icon'] = (i % 3) + 1
//         request['id'] = i
//         requests.push({ ...request })
//     }

//     return requests

// }

// export function handleRequest({method, page, id}) {
//     if (method === 'get') {
//         let requests = fetchRequets()
//         const size = requests.length
//         if ((page * 5) <= size) {
//             return requests.slice((page - 1) * 5, page * 5)
//         }
//         else{
//             return requests.slice((page - 1) * 5, size)
//         }
//     }
//     else if(method === 'del'){
//             delArchive(id)
//     }
// }

// function delArchive(id){
    
    
// }



const GO_SERVER_BASE_URL = "http://localhost:8080"; // Make sure this matches your Go server's port

/**
 * Fetches and lists all requests from the GoLang server's /api/requests/ endpoint.
 * This function expects the Go server to return the 'results' array directly.
 * @returns {Promise<Array|null>} A promise that resolves to an array of request objects
 * or null if an error occurs.
 */
export async function listRequests() {
    const url = `${GO_SERVER_BASE_URL}/api/requests/`;
    console.log(`Attempting to list requests from: ${url}`);

    try {
        const response = await fetch(url, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
                // No Authorization header needed here, as the Go server adds it.
            },
        });

        if (!response.ok) {
            const errorText = await response.text();
            console.error(`HTTP error! Status: ${response.status}, Body: ${errorText}`);
            // You could display a message box here instead of console.error
            return null;
        }

        const data = await response.json();
        for(let key in data){
            
            let text = ''
            for (let segment in data[key]['segments']){
                text += data[key]['segments'][segment]['text']
            }
            data[key]['text'] = text
        }
        console.log("Successfully listed requests:", data);
        return data; // This should be the 'results' array from the Go server
    } catch (error) {
        console.error("Error listing requests:", error);
        // You could display a message box here instead of console.error
        return null;
    }
}

/**
 * Deletes a specific request using its ID via the GoLang server's /api/requests/{id}/ endpoint.
 * @param {string} requestId The ID of the request to delete.
 * @returns {Promise<boolean>} A promise that resolves to true if deletion was successful,
 * false otherwise.
 */
export async function deleteRequest(requestId) {
    if (!requestId) {
        console.error("Request ID is required for deletion.");
        // You could display a message box here instead of console.error
        return false;
    }

    const url = `${GO_SERVER_BASE_URL}/api/requests/${requestId}/`;
    console.log(`Attempting to delete request with ID ${requestId} from: ${url}`);

    try {
        const response = await fetch(url, {
            method: 'DELETE',
            headers: {
                // No Authorization header needed here, as the Go server adds it.
            },
        });

        if (response.status === 204) { // 204 No Content is expected for successful DELETE
            console.log(`Request with ID ${requestId} deleted successfully.`);
            return true;
        } else if (response.status === 404) {
            console.warn(`Request with ID ${requestId} not found.`);
            // You could display a message box here instead of console.warn
            return false;
        } else {
            const errorText = await response.text();
            console.error(`HTTP error! Status: ${response.status}, Body: ${errorText}`);
            // You could display a message box here instead of console.error
            return false;
        }
    } catch (error) {
        console.error(`Error deleting request with ID ${requestId}:`, error);
        // You could display a message box here instead of console.error
        return false;
    }
}
